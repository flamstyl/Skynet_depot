{
  "rules": {
    "dangerousPatterns": [
      {
        "pattern": "rm\\s+-rf\\s+/",
        "severity": "critical",
        "message": "Attempting to delete root directory"
      },
      {
        "pattern": "dd\\s+if=/dev/(zero|random)\\s+of=/dev/(sd|hd|nvme)",
        "severity": "critical",
        "message": "Attempting to wipe disk"
      },
      {
        "pattern": "chmod\\s+-R\\s+777\\s+/",
        "severity": "critical",
        "message": "Attempting to change root permissions"
      },
      {
        "pattern": "wget.*\\|\\s*(sh|bash)",
        "severity": "high",
        "message": "Downloading and executing remote script"
      },
      {
        "pattern": "curl.*\\|\\s*(sh|bash)",
        "severity": "high",
        "message": "Downloading and executing remote script"
      },
      {
        "pattern": "\\:.*\\{.*\\:\\|\\:.*\\}",
        "severity": "critical",
        "message": "Fork bomb detected"
      },
      {
        "pattern": "mkfs\\.",
        "severity": "critical",
        "message": "Attempting to format filesystem"
      },
      {
        "pattern": "sudo\\s+su\\s+-",
        "severity": "medium",
        "message": "Escalating to root shell"
      }
    ],
    "suspiciousPatterns": [
      {
        "pattern": "nc\\s+-l.*-e",
        "severity": "high",
        "message": "Starting reverse shell with netcat"
      },
      {
        "pattern": "/dev/tcp/.*exec",
        "severity": "high",
        "message": "Bash reverse shell detected"
      },
      {
        "pattern": "python.*-m\\s+http\\.server",
        "severity": "low",
        "message": "Starting HTTP server"
      }
    ],
    "requireConfirmation": [
      "sudo",
      "rm -rf",
      "format",
      "fdisk",
      "parted",
      "shutdown",
      "reboot",
      "poweroff"
    ]
  },
  "pathProtection": {
    "systemPaths": [
      "/etc",
      "/bin",
      "/sbin",
      "/usr/bin",
      "/usr/sbin",
      "/boot",
      "/sys",
      "/proc"
    ],
    "requireSudoFor": [
      "/etc",
      "/var",
      "/usr/local",
      "/opt"
    ]
  }
}
