<Window
    x:Class="SkynetCompanion.Windows.OverlayWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:SkynetCompanion.Controls"
    mc:Ignorable="d"
    Title="Skynet Overlay">

    <!-- TODO: Set window to always-on-top, semi-transparent, draggable -->

    <Grid x:Name="RootGrid" CornerRadius="12">
        <!-- Background with opacity -->
        <Grid.Background>
            <SolidColorBrush Color="#1E1E1E" Opacity="0.95"/>
        </Grid.Background>

        <!-- Border -->
        <Border
            BorderBrush="{ThemeResource SkynetAccentBrush}"
            BorderThickness="2"
            CornerRadius="12"/>

        <!-- Main Layout -->
        <Grid Margin="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/> <!-- Header -->
                <RowDefinition Height="Auto"/> <!-- Tab Navigation -->
                <RowDefinition Height="*"/>    <!-- Content -->
            </Grid.RowDefinitions>

            <!-- Header (draggable area) -->
            <Grid
                x:Name="HeaderGrid"
                Grid.Row="0"
                Background="{ThemeResource SkynetAccentBrush}"
                Height="40"
                CornerRadius="12,12,0,0"
                ManipulationMode="TranslateX,TranslateY"
                ManipulationStarted="HeaderGrid_ManipulationStarted"
                ManipulationDelta="HeaderGrid_ManipulationDelta">

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock
                        x:Name="StatusIcon"
                        Text="ðŸ¤–"
                        FontSize="20"
                        Margin="0,0,8,0"/>
                    <TextBlock
                        Text="Skynet Companion"
                        FontSize="14"
                        FontWeight="SemiBold"
                        Foreground="White"
                        VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Minimize button -->
                <Button
                    x:Name="MinimizeButton"
                    Content="â€”"
                    Click="MinimizeButton_Click"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Margin="0,0,8,0"
                    Width="30"
                    Height="30"
                    Background="Transparent"
                    Foreground="White"/>
            </Grid>

            <!-- Tab Navigation -->
            <Grid Grid.Row="1" Background="#252525" Height="40">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="0">
                    <Button
                        x:Name="ChatTabButton"
                        Content="ðŸ’¬ Chat"
                        Click="ChatTabButton_Click"
                        Style="{StaticResource TabButtonStyle}"
                        Width="120"/>
                    <Button
                        x:Name="ActionsTabButton"
                        Content="âš¡ Actions"
                        Click="ActionsTabButton_Click"
                        Style="{StaticResource TabButtonStyle}"
                        Width="120"/>
                    <Button
                        x:Name="MemoryTabButton"
                        Content="ðŸ§  Memory"
                        Click="MemoryTabButton_Click"
                        Style="{StaticResource TabButtonStyle}"
                        Width="120"/>
                </StackPanel>
            </Grid>

            <!-- Content Area -->
            <Grid Grid.Row="2" x:Name="ContentGrid">
                <!-- Chat Panel -->
                <controls:ChatPanel
                    x:Name="ChatPanel"
                    Visibility="Visible"/>

                <!-- Quick Actions Panel -->
                <controls:QuickActions
                    x:Name="QuickActionsPanel"
                    Visibility="Collapsed"/>

                <!-- Memory Panel -->
                <controls:MemoryPanel
                    x:Name="MemoryPanelControl"
                    Visibility="Collapsed"/>
            </Grid>
        </Grid>

        <!-- Listening Indicator (shown when recording voice) -->
        <Grid
            x:Name="ListeningIndicator"
            Visibility="Collapsed"
            Background="#1E1E1E"
            Opacity="0.98"
            CornerRadius="12">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <TextBlock
                    Text="ðŸŽ¤"
                    FontSize="48"
                    HorizontalAlignment="Center"
                    Margin="0,0,0,20"/>
                <TextBlock
                    Text="Listening..."
                    FontSize="24"
                    Foreground="{ThemeResource SkynetAccentBrush}"
                    HorizontalAlignment="Center"/>
                <ProgressRing
                    IsActive="True"
                    Width="40"
                    Height="40"
                    Margin="0,20,0,0"
                    Foreground="{ThemeResource SkynetAccentBrush}"/>
            </StackPanel>
        </Grid>
    </Grid>

    <!-- TODO: Add resources for TabButtonStyle -->
</Window>
